syntax = "proto3";
// buf:lint:ignore PACKAGE_DIRECTORY_MATCH
package appsets.api.v1;

option go_package = "github.com/appsets/protocol/go/api/v1;apipb";

import "google/api/annotations.proto";
import "google/rpc/status.proto";

message InitializePurchaseAlipayRequest {
  string product_type = 1;
  string product_id = 2;
  int64 count = 3;
  int64 price = 4;
  int64 actual_price = 5;
  int64 total_amount = 6;
  int64 actual_total_amount = 7;
  string comment = 8;
  map<string, string> metadata = 9;
}

message InitializePurchaseAlipayResponse {
  google.rpc.Status error = 1;
  string transaction_id = 2;
  string payload = 3;
  int64 expired_at = 4;
}

message ValidatePurchaseAlipayRequest {
}

message ValidatePurchaseAlipayResponse {
  google.rpc.Status error = 1;
}

message CancelPurchaseRequest {
  string transaction_id = 1;
}

message CancelPurchaseResponse {
  google.rpc.Status error = 1;
}

service PurchaseService {
  rpc InitializePurchaseAlipay(InitializePurchaseAlipayRequest) returns (InitializePurchaseAlipayResponse) {
    option (google.api.http) = {
      post: "/api/v1/purchase/alipay/initialize"
      body: "*"
    };
  }

  rpc ValidatePurchaseAlipay(ValidatePurchaseAlipayRequest) returns (ValidatePurchaseAlipayResponse) {
    option (google.api.http) = {
      post: "/api/v1/purchase/alipay/validate"
      body: "*"
    };
  }

  rpc CancelPurchase(CancelPurchaseRequest) returns (CancelPurchaseResponse) {
    option (google.api.http) = {
      post: "/api/v1/purchase/cancel"
      body: "*"
    };
  }
}